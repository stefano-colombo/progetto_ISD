
<!DOCTYPE html>
<html lang="">
<head>
    <title th:value="${@environment.getProperty('custom.mittente')}"></title>

</head>
 
<body>

	<table >
	<tr> 
		<th></th>
		<th></th>
		<th><h2>Chat</h2></th> 
	</tr>
	
	<tr rowspan="2">
		<td align="left"> 
		<div name="invio_di_file_e_messaggi">
					
					<table >
					    <form th:action="@{/messaggio}"  method="post" th:object="${messaggio}">
						  		<input type="hidden"  th:value="messaggio" name="tipo">
						  		<!-- <input type="hidden"  th:value="${@environment.getProperty('custom.mittente')}" name="mittente"></input> -->
						  		<input type="hidden"  th:value="${@environment.getProperty('custom.mittente')}" name="mittente">
						  		<input type="hidden"  th:value="vuoto" name="nome">
						  		<input type="hidden"  th:value="vuoto" name="estensione">
						  		<input type="hidden"  th:value="vuoto" name="link">
						  		
						        <tr>
						        	 <th>messaggio:</th>
									 <td ><input type="text" laceholder="scrivi un messaggio" name="contenuto"></td>
						        	 <td><input type="submit" value="invia"></td> 
						        </tr>
					    </form>
					</table>
					
					<table>
						<form method="POST" enctype="multipart/form-data" id="form_carica_file">
							<tr>		
								<td>File:</td>
								<td> <input type="file" id="input_carica_file" placeholder="Upload Multiple Files"  name="files" multiple></td>
								<td><button type="submit" id="bottone_carica">Carica</button></td>
							</tr>
					    </form>
					</table>
					
					<div name="allert" th:if="${message}">
						<strong><span th:text="${message}"/></strong>
						<hr>
					</div>
		</div>
		</td>
	
		
		<td name=spazio>
			<font color="white"> spazio piu grandeeee</font>
		</td>
		
		
		
		<td name="storico_messaggi" align="center">
			
			<table id="tabella_messaggi" class="table">
				
					<tr name="nomi">
						<th></th>
						<th align="left">Io &ensp; &ensp; &ensp; &ensp;</th>
						<th align="left" ></th>
						<th align="right" >L'altro</th>
						<th></th>
						
					</tr>

					<tr th:each="m:${messaggi}">
			
						<span th:with="mittente=${@environment.getProperty('custom.mittente')}">
							<span  th:if="${m.mittente ==mittente}">
								<span th:if="${m.tipo == 'messaggio'}">
									<td></td>
									<td align="left" th:text="${m.contenuto}"></td>
									<td></td>
									<td></td>
									<td></td>
								</span>
							
								<span th:if="${m.tipo == 'file'}">
									<td align="left">ðŸ“¦</td>
									<td align="left"> <a th:href="${m.link}" > <div th:text="${m.nome}"></div> </a>  </td>
									<td></td>
									<td></td>
									<td></td>
								</span> 
							</span>
						</span>
						
						<span th:with="destinatario=${@environment.getProperty('custom.destinatario')}">
							<span th:if="${m.mittente ==destinatario }">
								<span th:if="${m.tipo == 'messaggio'}">
									<td></td>
									<td></td>
									<td></td>
									<td align="right" th:text="${m.contenuto}"></td>
									<td></td>
									
								</span>
								<span th:if="${m.tipo == 'file'}">
									<td></td>
									<td></td>
									<td></td>
									<td align="right"> <a th:href="${m.link}" > <div th:text="${m.nome}"></div> </a>  </td>
									<td align="right">ðŸ“¦</td>
								</span> 
							</span> 
						</span>	
							
				    </tr>
			
			</table>
		</div></td>
	</tr></table>	

</body>
</html>


